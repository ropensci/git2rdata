<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started Storing Dataframes as Plain Text • git2rdata</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Getting Started Storing Dataframes as Plain Text">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">git2rdata</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="../articles/plain_text.html">Getting started storing dataframes as plain text</a></li>
    <li><a class="dropdown-item" href="../articles/version_control.html">Storing dataframes under version control</a></li>
    <li><a class="dropdown-item" href="../articles/metadata.html">Metadata</a></li>
    <li><a class="dropdown-item" href="../articles/workflow.html">Potential workflow</a></li>
    <li><a class="dropdown-item" href="../articles/efficiency.html">Efficiency</a></li>
    <li><a class="dropdown-item" href="../articles/split_by.html">Large dataframes</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-contributing" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Contributing</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-contributing">
<li><a class="dropdown-item" href="../CONTRIBUTING.html">Contributing</a></li>
    <li><a class="dropdown-item" href="../CODE_OF_CONDUCT.html">Code of conduct</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ropensci/git2rdata/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Getting Started Storing Dataframes as Plain Text</h1>
                        <h4 data-toc-skip class="author">Thierry
Onkelinx</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/git2rdata/blob/main/vignettes/plain_text.Rmd" class="external-link"><code>vignettes/plain_text.Rmd</code></a></small>
      <div class="d-none name"><code>plain_text.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette motivates why we wrote <code>git2rdata</code> and
illustrates how you can use it to store dataframes as plain text
files.</p>
<div class="section level3">
<h3 id="maintaining-variable-classes">Maintaining Variable Classes<a class="anchor" aria-label="anchor" href="#maintaining-variable-classes"></a>
</h3>
<p>R has different options to store dataframes as plain text files from
R. Base R has <code><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.table()</a></code> and its companions like
<code><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv()</a></code>. Some other options are
<code><a href="https://rdatatable.gitlab.io/data.table/reference/fwrite.html" class="external-link">data.table::fwrite()</a></code>, <code><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">readr::write_delim()</a></code>,
<code><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">readr::write_csv()</a></code> and <code><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">readr::write_tsv()</a></code>.
Each of them writes a dataframe as a plain text file by converting all
variables into characters. After reading the file, they revert this
conversion. The distinction between <code>character</code> and
<code>factor</code> gets lost in translation. <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table()</a></code>
converts by default all strings to factors,
<code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">readr::read_csv()</a></code> keeps by default all strings as
character. These functions cannot recover the factor levels. These
functions determine factor levels based on the observed levels in the
plain text file. Hence factor levels without observations will
disappear. The order of the factor levels is also determined by the
available levels in the plain text file, which can be different from the
original order.</p>
<p>The <code><a href="../reference/write_vc.html">write_vc()</a></code> and <code><a href="../reference/read_vc.html">read_vc()</a></code> functions from
<code>git2rdata</code> keep track of the class of each variable and, in
case of a factor, also of the factor levels and their order. Hence this
function pair preserves the information content of the dataframe. The
<code>vc</code> suffix stands for <strong>v</strong>ersion
<strong>c</strong>ontrol<!-- spell-check: ignore --> as these functions
use their full capacity in combination with a version control
system.</p>
</div>
</div>
<div class="section level2">
<h2 id="efficiency-relative-to-storage-and-time">Efficiency Relative to Storage and Time<a class="anchor" aria-label="anchor" href="#efficiency-relative-to-storage-and-time"></a>
</h2>
<div class="section level3">
<h3 id="optimizing-file-storage">Optimizing File Storage<a class="anchor" aria-label="anchor" href="#optimizing-file-storage"></a>
</h3>
<p>Plain text files require more disk space than binary files. This is
the price we have to pay for a readable file format. The default option
of <code><a href="../reference/write_vc.html">write_vc()</a></code> is to create file as compact as possible.
Since we use a tab delimited file format, we can omit quotes around
character variables. This saves 2 bytes per row for each character
variable. <code>write_vc</code> add quotes automatically in the
exceptional cases when we needed them, e.g. to store a string that
contains tab or newline characters. We don’t add quotes to row-variable
combinations where we don’t need them.</p>
<p>Since we store the class of each variable, we can further reduce the
file size by following rules:</p>
<ul>
<li>Store a <code>logical</code> as 0 (FALSE), 1 (TRUE) or NA to the
data.</li>
<li>Store a <code>factor</code> as its indices in the data. Store the
index, labels of levels and their order in the metadata.</li>
<li>Store a <code>POSIXct</code> as a numeric to the data. Store the
class and the origin in the metadata. Store and return timestamps as
UTC.</li>
<li>Store a <code>Date</code> as an integer to the data. Store the class
and the origin in the metadata.</li>
</ul>
<p>Storing the factors, POSIXct <!-- spell-check: ignore --> and Date as
their index, makes them less user readable. The user can turn off this
optimization when user readability is more important than file size.</p>
</div>
<div class="section level3">
<h3 id="optimized-for-version-control">Optimized for Version Control<a class="anchor" aria-label="anchor" href="#optimized-for-version-control"></a>
</h3>
<p>Another main goal of <code>git2rdata</code> is to optimise the
storage of the plain text files under version control.
<code><a href="../reference/write_vc.html">write_vc()</a></code> and <code><a href="../reference/read_vc.html">read_vc()</a></code> has methods for
interacting with <a href="https://git-scm.com/" class="external-link">git</a> repositories
using the <code>git2r</code> framework. Users who want to use git
without <code>git2r</code> or use a different version control system
(e.g. <a href="https://subversion.apache.org/" class="external-link">Subversion</a>, <a href="https://www.mercurial-scm.org/" class="external-link">Mercurial</a>), still can use
<code>git2rdata</code> to write the files to disk and uses their
preferred workflow on version control.</p>
<p>Hence, <code><a href="../reference/write_vc.html">write_vc()</a></code> will always perform checks to look for
changes which potentially lead to large diffs. More details on this in
<code><a href="../articles/version_control.html">vignette("version_control", package = "git2rdata")</a></code>. Some
problems will always yield a warning. Other problems will yield an error
by default. The user can turn these errors into warnings by setting the
<code>strict = FALSE</code> argument.</p>
<p>As this vignette ignores the part on version control, we will always
use <code>write_vc(strict = FALSE)</code> and hide the warnings to
improve the readability.</p>
</div>
</div>
<div class="section level2">
<h2 id="basic-usage">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h2>
<p>Let’s start by setting up the environment. We need a directory to
store the data and a dataframe to store.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a directory in tempdir</span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"git2r-"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span>
<span><span class="co"># Create dummy data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20190222</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="fl">26</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span>,</span>
<span>  abc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  def <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="fl">26</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  timestamp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2018-01-01"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2019-01-01"</span><span class="op">)</span>,</span>
<span>    length <span class="op">=</span> <span class="fl">26</span></span>
<span>  <span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    26 obs. of  6 variables:</span></span>
<span><span class="co">#&gt;  $ x        : chr  "V" "U" "Z" "W" ...</span></span>
<span><span class="co">#&gt;  $ y        : Factor w/ 3 levels "a","b","c": 1 2 NA NA 1 NA 2 1 NA 1 ...</span></span>
<span><span class="co">#&gt;  $ z        : int  NA 1 2 3 4 5 6 7 8 9 ...</span></span>
<span><span class="co">#&gt;  $ abc      : num  -0.382 -0.42 -0.917 0.387 -0.992 ...</span></span>
<span><span class="co">#&gt;  $ def      : logi  TRUE FALSE NA FALSE NA NA ...</span></span>
<span><span class="co">#&gt;  $ timestamp: POSIXct, format: "2018-01-01 00:00:00" "2018-01-15 14:24:00" ...</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="storing-optimized">Storing Optimized<a class="anchor" aria-label="anchor" href="#storing-optimized"></a>
</h2>
<p>Use <code><a href="../reference/write_vc.html">write_vc()</a></code> to store the dataframe. The
<code>root</code> argument refers to the base directory where we store
the data. The <code>file</code> argument becomes the base name of the
files. The data file gets a <code>.tsv</code> extension, the metadata
file a <code>.yml</code> extension. <code>file</code> can include a
relative path starting from <code>root</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ropensci.github.io/git2rdata/">git2rdata</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/write_vc.html">write_vc</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, file <span class="op">=</span> <span class="st">"first_test"</span>, root <span class="op">=</span> <span class="va">path</span>, strict <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; 2b0ac8243ca27ed3d983ba8fc27a3bca7ca8f39d 79e04b2ecff2c1eac8ededc69ba09311f38f74da </span></span>
<span><span class="co">#&gt;                         "first_test.tsv"                         "first_test.yml"</span></span></code></pre></div>
<p><code><a href="../reference/write_vc.html">write_vc()</a></code> returns a vector of relative paths to the raw
data and metadata files. The names of this vector contains the hashes of
these files. We can have a look at both files. We’ll display the first
10 rows of the raw data. Notice that the YAML format of the metadata has
the benefit of being both human and machine readable.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">print_file</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">file</span>, <span class="va">root</span>, <span class="va">n</span> <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">root</span>, <span class="va">file</span><span class="op">)</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="va">fn</span>, n <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">data</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">print_file</span><span class="op">(</span><span class="st">"first_test.tsv"</span>, <span class="va">path</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; x    y   z   abc def timestamp</span></span>
<span><span class="co">#&gt; V    1   NA  -0.38201    1   1514764800</span></span>
<span><span class="co">#&gt; U    2   1   -0.420348   0   1516026240</span></span>
<span><span class="co">#&gt; Z    NA  2   -0.916731   NA  1517287680</span></span>
<span><span class="co">#&gt; W    NA  3   0.387455    0   1518549120</span></span>
<span><span class="co">#&gt; L    1   4   -0.992355   NA  1519810560</span></span>
<span><span class="co">#&gt; C    NA  5   0.0228714   NA  1521072000</span></span>
<span><span class="co">#&gt; R    2   6   -0.947557   1   1522333440</span></span>
<span><span class="co">#&gt; S    1   7   -0.163029   NA  1523594880</span></span>
<span><span class="co">#&gt; O    NA  8   0.523643    1   1524856320</span></span>
<span><span class="fu">print_file</span><span class="op">(</span><span class="st">"first_test.yml"</span>, <span class="va">path</span><span class="op">)</span></span>
<span><span class="co">#&gt; ..generic:</span></span>
<span><span class="co">#&gt;   git2rdata: 0.5.1</span></span>
<span><span class="co">#&gt;   optimize: yes</span></span>
<span><span class="co">#&gt;   NA string: NA</span></span>
<span><span class="co">#&gt;   hash: 79e04b2ecff2c1eac8ededc69ba09311f38f74da</span></span>
<span><span class="co">#&gt;   data_hash: 2b0ac8243ca27ed3d983ba8fc27a3bca7ca8f39d</span></span>
<span><span class="co">#&gt; x:</span></span>
<span><span class="co">#&gt;   class: character</span></span>
<span><span class="co">#&gt; 'y':</span></span>
<span><span class="co">#&gt;   class: factor</span></span>
<span><span class="co">#&gt;   labels:</span></span>
<span><span class="co">#&gt;   - a</span></span>
<span><span class="co">#&gt;   - b</span></span>
<span><span class="co">#&gt;   - c</span></span>
<span><span class="co">#&gt;   index:</span></span>
<span><span class="co">#&gt;   - 1</span></span>
<span><span class="co">#&gt;   - 2</span></span>
<span><span class="co">#&gt;   - 3</span></span>
<span><span class="co">#&gt;   ordered: no</span></span>
<span><span class="co">#&gt; z:</span></span>
<span><span class="co">#&gt;   class: integer</span></span>
<span><span class="co">#&gt; abc:</span></span>
<span><span class="co">#&gt;   class: numeric</span></span>
<span><span class="co">#&gt;   digits: 6</span></span>
<span><span class="co">#&gt; def:</span></span>
<span><span class="co">#&gt;   class: logical</span></span>
<span><span class="co">#&gt; timestamp:</span></span>
<span><span class="co">#&gt;   class: POSIXct</span></span>
<span><span class="co">#&gt;   origin: 1970-01-01 00:00:00</span></span>
<span><span class="co">#&gt;   timezone: UTC</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="storing-verbose">Storing Verbose<a class="anchor" aria-label="anchor" href="#storing-verbose"></a>
</h2>
<p>Adding <code>optimize = FALSE</code> to <code><a href="../reference/write_vc.html">write_vc()</a></code> will
keep the raw data in a human readable format. The metadata file is
slightly different. The most obvious is the <code>optimize: no</code>
tag and the different hash. Another difference is the metadata for
POSIXct <!-- spell-check: ignore --> and Date classes. They will no
longer have an origin tag but a format tag.</p>
<p>Another important difference is that we store the data file as comma
separated values instead of tab separated values. We noticed that the
<code>csv</code> file format is more easily recognised by a larger
audience as a data file.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/write_vc.html">write_vc</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, file <span class="op">=</span> <span class="st">"verbose"</span>, root <span class="op">=</span> <span class="va">path</span>, optimize <span class="op">=</span> <span class="cn">FALSE</span>, strict <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; a8979a8d3737e28729523ce04932453f1efbe04a 14cb4010f7f9f65eac46751c055904fc1e7d74e4 </span></span>
<span><span class="co">#&gt;                            "verbose.csv"                            "verbose.yml"</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_file</span><span class="op">(</span><span class="st">"verbose.csv"</span>, <span class="va">path</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; x,y,z,abc,def,timestamp</span></span>
<span><span class="co">#&gt; V,a,NA,-0.38201,TRUE,2018-01-01T00:00:00Z</span></span>
<span><span class="co">#&gt; U,b,1,-0.420348,FALSE,2018-01-15T14:24:00Z</span></span>
<span><span class="co">#&gt; Z,NA,2,-0.916731,NA,2018-01-30T04:48:00Z</span></span>
<span><span class="co">#&gt; W,NA,3,0.387455,FALSE,2018-02-13T19:12:00Z</span></span>
<span><span class="co">#&gt; L,a,4,-0.992355,NA,2018-02-28T09:36:00Z</span></span>
<span><span class="co">#&gt; C,NA,5,0.0228714,NA,2018-03-15T00:00:00Z</span></span>
<span><span class="co">#&gt; R,b,6,-0.947557,TRUE,2018-03-29T14:24:00Z</span></span>
<span><span class="co">#&gt; S,a,7,-0.163029,NA,2018-04-13T04:48:00Z</span></span>
<span><span class="co">#&gt; O,NA,8,0.523643,TRUE,2018-04-27T19:12:00Z</span></span>
<span><span class="fu">print_file</span><span class="op">(</span><span class="st">"verbose.yml"</span>, <span class="va">path</span><span class="op">)</span></span>
<span><span class="co">#&gt; ..generic:</span></span>
<span><span class="co">#&gt;   git2rdata: 0.5.1</span></span>
<span><span class="co">#&gt;   optimize: no</span></span>
<span><span class="co">#&gt;   NA string: NA</span></span>
<span><span class="co">#&gt;   hash: 14cb4010f7f9f65eac46751c055904fc1e7d74e4</span></span>
<span><span class="co">#&gt;   data_hash: a8979a8d3737e28729523ce04932453f1efbe04a</span></span>
<span><span class="co">#&gt; x:</span></span>
<span><span class="co">#&gt;   class: character</span></span>
<span><span class="co">#&gt; 'y':</span></span>
<span><span class="co">#&gt;   class: factor</span></span>
<span><span class="co">#&gt;   labels:</span></span>
<span><span class="co">#&gt;   - a</span></span>
<span><span class="co">#&gt;   - b</span></span>
<span><span class="co">#&gt;   - c</span></span>
<span><span class="co">#&gt;   index:</span></span>
<span><span class="co">#&gt;   - 1</span></span>
<span><span class="co">#&gt;   - 2</span></span>
<span><span class="co">#&gt;   - 3</span></span>
<span><span class="co">#&gt;   ordered: no</span></span>
<span><span class="co">#&gt; z:</span></span>
<span><span class="co">#&gt;   class: integer</span></span>
<span><span class="co">#&gt; abc:</span></span>
<span><span class="co">#&gt;   class: numeric</span></span>
<span><span class="co">#&gt;   digits: 6</span></span>
<span><span class="co">#&gt; def:</span></span>
<span><span class="co">#&gt;   class: logical</span></span>
<span><span class="co">#&gt; timestamp:</span></span>
<span><span class="co">#&gt;   class: POSIXct</span></span>
<span><span class="co">#&gt;   format: '%Y-%m-%dT%H:%M:%SZ'</span></span>
<span><span class="co">#&gt;   timezone: UTC</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="efficiency-relative-to-file-storage">Efficiency Relative to File Storage<a class="anchor" aria-label="anchor" href="#efficiency-relative-to-file-storage"></a>
</h2>
<p>Storing dataframes optimized or verbose has an impact on the required
file size. The <a href="efficiency.html#on-a-file-system">efficiency</a>
vignette give a comparison.</p>
</div>
<div class="section level2">
<h2 id="reading-data">Reading Data<a class="anchor" aria-label="anchor" href="#reading-data"></a>
</h2>
<p>You retrieve the data with <code><a href="../reference/read_vc.html">read_vc()</a></code>. This function will
reinstate the variables to their original state.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_vc.html">read_vc</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"first_test"</span>, root <span class="op">=</span> <span class="va">path</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, check.attributes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Component \"abc\": Mean relative difference: 5.679135e-07"                  </span></span>
<span><span class="co">#&gt; [2] "Component \"timestamp\": 'tzone' attributes are inconsistent ('' and 'UTC')"</span></span>
<span><span class="va">y2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_vc.html">read_vc</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"verbose"</span>, root <span class="op">=</span> <span class="va">path</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y2</span>, check.attributes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Component \"abc\": Mean relative difference: 5.679135e-07"                  </span></span>
<span><span class="co">#&gt; [2] "Component \"timestamp\": 'tzone' attributes are inconsistent ('' and 'UTC')"</span></span></code></pre></div>
<p><code><a href="../reference/read_vc.html">read_vc()</a></code> requires the meta data. It cannot handle
dataframe not stored by <code><a href="../reference/write_vc.html">write_vc()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="missing-values">Missing Values<a class="anchor" aria-label="anchor" href="#missing-values"></a>
</h2>
<p><code><a href="../reference/write_vc.html">write_vc()</a></code> has an <code>na</code> argument which
specifies the string which to use for missing values. Because we avoid
using quotes, this string must be different from any character value in
the data. This includes factor labels with verbose data storage.
<code><a href="../reference/write_vc.html">write_vc()</a></code> checks this and will always return an error,
even with <code>strict = FALSE</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/write_vc.html">write_vc</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"custom_na"</span>, <span class="va">path</span>, strict <span class="op">=</span> <span class="cn">FALSE</span>, na <span class="op">=</span> <span class="st">"X"</span>, optimize <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error: one of the strings matches the NA string ('X')</span></span>
<span><span class="co">#&gt; Please use a different NA string or consider using a factor.</span></span>
<span><span class="fu"><a href="../reference/write_vc.html">write_vc</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"custom_na"</span>, <span class="va">path</span>, strict <span class="op">=</span> <span class="cn">FALSE</span>, na <span class="op">=</span> <span class="st">"b"</span>, optimize <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error: one of the levels matches the NA string ('b').</span></span>
<span><span class="co">#&gt; Please use a different NA string or use optimize = TRUE</span></span>
<span><span class="fu"><a href="../reference/write_vc.html">write_vc</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"custom_na"</span>, <span class="va">path</span>, strict <span class="op">=</span> <span class="cn">FALSE</span>, na <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error: one of the strings matches the NA string ('X')</span></span>
<span><span class="co">#&gt; Please use a different NA string or consider using a factor.</span></span>
<span><span class="fu"><a href="../reference/write_vc.html">write_vc</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"custom_na"</span>, <span class="va">path</span>, strict <span class="op">=</span> <span class="cn">FALSE</span>, na <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 9af818152e63482469c89ea7432fda1216f5eaf1 42235e10f9b5734d8718d02799d3ca6760c6a640 </span></span>
<span><span class="co">#&gt;                          "custom_na.tsv"                          "custom_na.yml"</span></span></code></pre></div>
<p>Please note that <code><a href="../reference/write_vc.html">write_vc()</a></code> uses the same NA string for
the entire dataset, thus for every variable.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print_file</span><span class="op">(</span><span class="st">"custom_na.tsv"</span>, <span class="va">path</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; x    y   z   abc def timestamp</span></span>
<span><span class="co">#&gt; V    1   b   -0.38201    1   1514764800</span></span>
<span><span class="co">#&gt; U    2   1   -0.420348   0   1516026240</span></span>
<span><span class="co">#&gt; Z    b   2   -0.916731   b   1517287680</span></span>
<span><span class="co">#&gt; W    b   3   0.387455    0   1518549120</span></span>
<span><span class="co">#&gt; L    1   4   -0.992355   b   1519810560</span></span>
<span><span class="co">#&gt; C    b   5   0.0228714   b   1521072000</span></span>
<span><span class="co">#&gt; R    2   6   -0.947557   1   1522333440</span></span>
<span><span class="co">#&gt; S    1   7   -0.163029   b   1523594880</span></span>
<span><span class="co">#&gt; O    b   8   0.523643    1   1524856320</span></span>
<span><span class="fu">print_file</span><span class="op">(</span><span class="st">"custom_na.yml"</span>, <span class="va">path</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; ..generic:</span></span>
<span><span class="co">#&gt;   git2rdata: 0.5.1</span></span>
<span><span class="co">#&gt;   optimize: yes</span></span>
<span><span class="co">#&gt;   NA string: b</span></span></code></pre></div>
<p>The default string for missing values is <code>"NA"</code>. We
recommend to keep this default, as long as the dataset permits it. A
first good alternative is an empty string (<code>""</code>). If that
won’t work either, you’ll have to use your imagination. Try to keep it
short, clear and robust<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;robust in the sense that you won’t need to change it
later&lt;/p&gt;"><sup>1</sup></a>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/write_vc.html">write_vc</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"custom_na"</span>, <span class="va">path</span>, strict <span class="op">=</span> <span class="cn">FALSE</span>, na <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="co">#&gt; af77e2ece69634db88061c747cc833d868640218 e58a31060d6f1e2f42e3541bf26276fa1f8102f4 </span></span>
<span><span class="co">#&gt;                          "custom_na.tsv"                          "custom_na.yml"</span></span></code></pre></div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.muscardinus.be" class="external-link">Thierry Onkelinx</a>, <a href="https://www.vlaanderen.be/inbo/en-gb" class="external-link"><img src="https://inbo.github.io/checklist/reference/figures/logo-en.png" height="24" alt="Research Institute for Nature and Forest (INBO)"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
